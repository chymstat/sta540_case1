Description = "Description",
`Did not order test kit n/N` = md("Did not order test kit<br>n/N"),
`Ordered test kit n/N` = md("Ordered test kit<br>n/N"),
`Did not order test kit Percent` = md("Did not order test kit<br>Percent"),
`Ordered test kit Percent` = md("Ordered test kit<br>Percent"),
`P-value` = "P-value"
) %>%
fmt_number(
columns = ends_with("Percent"),
decimals = 1
) %>%
fmt_number(
columns = `P-value`,
decimals = 3
) %>%
cols_align(
align = "left",
columns = c(Stage, Description)
) %>%
cols_align(
align = "center",
columns = -c(Stage, Description)
) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_body(columns = Stage)
)
gtsave(
stage_gt,
filename = "b. stage_of_health_behavior_change.html"
)
keep_rows <- c(1, 5, 9, 13, 17, 21, 25)
q14_final_table_display <- q14_final_table %>%
mutate(
Statements = if_else(
row_number() %in% keep_rows,
Statements,
""
)
)
gt(q14_final_table_display) %>%
tab_header(
title = md("**e. HIV-related stigma among study participants**")
) %>%
fmt_markdown(everything()) %>%
cols_align(
align = "center",
-Statements
) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_body(
columns = Statements,
rows = Statements != ""
)
) %>%
gtsave("e. hiv_stigma.html")
keep_rows14 <- c(1, 8, 15, 22)
q14_final_table_display <- q14_final_table %>%
mutate(
Statements = if_else(
row_number() %in% keep_rows,
Statements,
""
)
)
gt(q14_final_table_display) %>%
tab_header(
title = md("**e. HIV-related stigma among study participants**")
) %>%
fmt_markdown(everything()) %>%
cols_align(
align = "center",
-Statements
) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_body(
columns = Statements,
rows = Statements != ""
)
) %>%
gtsave("e. hiv_stigma.html")
q14_final_table_display <- q14_final_table %>%
mutate(
Statements = if_else(
row_number() %in% keep_rows14,
Statements,
""
)
)
gt(q14_final_table_display) %>%
tab_header(
title = md("**e. HIV-related stigma among study participants**")
) %>%
fmt_markdown(everything()) %>%
cols_align(
align = "center",
-Statements
) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_body(
columns = Statements,
rows = Statements != ""
)
) %>%
gtsave("e. hiv_stigma.html")
View(q94_table)
gt(q94_table) %>%
tab_header(
title = md("**d. Attitudes toward HIV treatment (continuous scale from 1 [strongly disagree] to 7 [strongly agree])**")
) %>%
fmt_markdown(everything()) %>%
cols_align(
align = "center",
-Statements
) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_body(
columns = Statements,
rows = Statements != ""
)
) %>%
gtsave("d. hiv_attitudes.html")
View(final_tableq15)
colnames(final_tableq15) <- c(
"Statements",
"Response",
"n/N_Did not order test kit",
"n/N_Ordered test kit",
"percent_Did not order test kit",
"percent_Ordered test kit",
"P-value"
)
keep_rows15 <- c(1, 3, 5, 7, 9)
q15_final_table_display <- final_tableq15 %>%
mutate(
Statements = if_else(
row_number() %in% keep_rows15,
Statements,
""
)
)
gt(q15_final_table_display) %>%
tab_header(
title = md("**c. Attitudes toward HIV testing**")
) %>%
fmt_markdown(everything()) %>%
cols_align(
align = "center",
-Statements
) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_body(
columns = Statements,
rows = Statements != ""
)
) %>%
gtsave("c. hiv_test.html")
ggplot(
q8_2_long,
aes(
x = percent,
y = factor(statement, levels = q8_2_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = 1,
name = NULL,
limits = levels(q8_2_long$response_label)
) +
labs(x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(
q7_long,
aes(
x = percent,
y = factor(statement, levels = q7_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5, reverse = FALSE),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = -1,
name = NULL,
limits = levels(q7_long$response_label)
) +
labs(
title = "Figure S1. Opinions about PrEP among participants of the National Institute on Drug Abuse Clinical Trials Network Social Media PrEP Study, 2020. Note: values below 5% are not labeled on the figure.",
x = NULL,
y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(
q7_long,
aes(
x = percent,
y = factor(statement, levels = q7_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5, reverse = FALSE),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = -1,
name = NULL,
limits = levels(q7_long$response_label)
) +
labs(
title = "Figure S1. Opinions about PrEP among participants",
x = NULL,
y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggsave(
filename = "q7_likert_plot.png",
plot = p_q7,
width = 8,
height = 5,
dpi = 300
)
p_q7 <- ggplot(
q7_long,
aes(
x = percent,
y = factor(statement, levels = q7_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5, reverse = FALSE),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = -1,
name = NULL,
limits = levels(q7_long$response_label)
) +
labs(
title = "Figure S1. Opinions about PrEP among participants",
x = NULL,
y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggsave(
filename = "q7_likert_plot.png",
plot = p_q7,
width = 8,
height = 5,
dpi = 300
)
ggplot(
q8_long,
aes(
x = percent,
y = factor(statement, levels = q8_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = -1,
name = NULL,
limits = levels(q8_long$response_label)
) +
labs(
title = "Figure S2. Reported barriers to PrEP among participants",
x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(
q8_2_long,
aes(
x = percent,
y = factor(statement, levels = q8_2_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = 1,
name = NULL,
limits = levels(q8_2_long$response_label)
) +
labs(
title = "Figure S3. Reported facilitators to PrEP among participants",
x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(
q8_long,
aes(
x = percent,
y = factor(statement, levels = q8_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = -1,
name = NULL,
limits = levels(q8_long$response_label)
) +
labs(
title = "Figure S2. Reported barriers to PrEP uptake among participants",
x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(
q8_2_long,
aes(
x = percent,
y = factor(statement, levels = q8_2_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = 1,
name = NULL,
limits = levels(q8_2_long$response_label)
) +
labs(
title = "Figure S3. Reported facilitators to PrEP uptake among participants",
x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
ggplot(
q7_long,
aes(
x = percent,
y = factor(statement, levels = q7_items$statement),
fill = response_label
)
) +
geom_col(width = 0.8) +
geom_text(
aes(label = ifelse(percent >= 5,
paste0(round(percent, 1), "%"),
"")),
position = position_stack(vjust = 0.5, reverse = FALSE),
size = 3
) +
scale_x_continuous(
limits = c(0, 100),
expand = c(0, 0),
labels = function(x) paste0(x, "%")
) +
scale_fill_brewer(
palette = "RdBu",
direction = -1,
name = NULL,
limits = levels(q7_long$response_label)
) +
labs(
title = "Figure S1. Opinions about PrEP among participants",
x = NULL,
y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom"
)
View(hivtest_summary)
View(res_w1)
anova(fit_BC, fit_full, test = "Chisq")
View(alcohol_dt)
View(alcohol_table)
View(alcohol_tbl)
